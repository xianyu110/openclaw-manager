# 🎯 OpenClaw Manager 功能详解

## 核心功能

### 1. 自动发现 Gateway 实例 🔍

系统会自动扫描 `~/.openclaw-*` 目录，读取配置文件并显示所有 Gateway 实例。

**特性：**
- 自动读取端口、模型、Agent 信息
- 缓存机制（1分钟 TTL）提升性能
- 支持手动刷新发现

**使用方法：**
- 启动时自动扫描
- 点击"🔍 重新扫描"按钮手动刷新

---

### 2. 创建新 Gateway ➕

通过图形界面创建新的 Gateway 实例，无需手动编辑配置文件。

**配置项：**

#### 基础信息
- **Profile ID**: 唯一标识符（如 `my-assistant`）
- **机器人名称**: 显示名称（如 `我的助手`）
- **端口号**: Gateway 监听端口（建议 18789-18799）

#### Agent 配置
- **Agent ID**: Agent 标识符（如 `main-agent`）
- **AI 模型**: 
  - 预设模型：从下拉列表选择
  - 自定义模型：输入任意模型 ID（如 `gpt-4o`, `claude-3-opus-20240229`）

#### 飞书配置
- **App ID**: 飞书应用 ID（`cli_xxxxxxxxxxxxxxxx`）
- **App Secret**: 飞书应用密钥

#### 人格设定 📝
- **SOUL.md 编辑器**: 使用 Markdown 定义 Agent 的：
  - 角色定位
  - 性格特点
  - 专业领域
  - 回答风格
  - 工作方式

**示例 SOUL.md：**

```markdown
# 技术顾问 Agent

## 角色定位
你是一个资深的技术顾问，专注于软件架构和系统设计。

## 性格特点
- 严谨、专业
- 注重细节和最佳实践
- 善于分析复杂问题

## 专业领域
- 微服务架构
- 云原生技术
- DevOps 实践
- 性能优化

## 回答风格
- 先理解需求，再提供方案
- 给出具体可行的建议
- 必要时提供代码示例和架构图
- 考虑可扩展性和维护性

## 工作方式
1. 仔细分析用户的技术需求
2. 评估不同方案的优缺点
3. 推荐最适合的技术栈
4. 提供实施步骤和注意事项
```

**操作步骤：**
1. 点击"➕ 新建 Gateway"按钮
2. 填写所有必填字段
3. 选择或输入 AI 模型
4. （可选）展开人格编辑器，自定义 SOUL.md
5. 点击"创建"按钮

**自动创建的文件结构：**
```
~/.openclaw-{profileId}/
├── openclaw.json                    # Gateway 配置
└── agent-configs/
    └── {agentId}/
        └── SOUL.md                  # Agent 人格设定
```

---

### 3. 编辑 Gateway ✏️

修改现有 Gateway 的配置和人格设定。

**可修改项：**
- 机器人名称
- 端口号
- Agent ID
- AI 模型（预设或自定义）
- 飞书 App ID 和 Secret（可选）
- SOUL.md 人格设定

**操作步骤：**
1. 在服务卡片中点击"✏️ 编辑"按钮
2. 修改需要更改的字段
3. 展开人格编辑器修改 SOUL.md
4. 点击"保存"按钮

**注意事项：**
- Profile ID 不可修改
- 飞书密钥留空则不修改
- 修改后需要重启 Gateway 才能生效

---

### 4. 删除 Gateway 🗑️

完全移除 Gateway 实例及其所有配置。

**删除内容：**
- Gateway 配置文件
- Agent 配置目录
- SOUL.md 人格文件
- launchd 保活配置（如果存在）

**操作步骤：**
1. 在服务卡片中点击"🗑️ 删除"按钮
2. 确认删除操作
3. 系统自动停止服务并删除所有文件

**⚠️ 警告：**
- 删除操作不可恢复
- 建议先备份重要配置

---

### 5. 服务控制 🎮

#### 批量操作
- **⚙️ 配置保活**: 配置 launchd 保活服务（开机自启、崩溃重启）
- **▶️ 启动所有**: 启动所有 Gateway 实例
- **⏹️ 停止所有**: 停止所有 Gateway 实例
- **🔄 重启所有**: 重启所有 Gateway 实例

#### 单个操作
- **✏️ 编辑**: 编辑 Gateway 配置
- **🗑️ 删除**: 删除 Gateway
- **📝 日志**: 查看运行日志

---

### 6. 实时状态监控 📊

**显示信息：**
- 运行状态（运行中/已停止）
- 端口号
- 使用的 AI 模型
- launchd 保活状态

**状态指示：**
- 🟢 绿色：运行中
- 🔴 红色：已停止
- ⚪ 灰色：未知

**自动刷新：**
- 每 10 秒自动刷新状态
- 可手动点击"刷新状态"按钮

---

## 使用场景

### 场景 1: 创建专业领域助手

**需求：** 创建一个专注于前端开发的技术助手

**步骤：**
1. 点击"➕ 新建 Gateway"
2. 填写基础信息：
   - Profile ID: `frontend-expert`
   - 机器人名称: `前端专家`
   - 端口: `18793`
3. 配置 Agent：
   - Agent ID: `frontend-agent`
   - 模型: `Claude Sonnet 4.5 Thinking`
4. 展开人格编辑器，定义专业领域：

```markdown
# 前端开发专家

## 角色定位
你是一个资深的前端开发工程师，精通现代前端技术栈。

## 专业领域
- React / Vue / Angular
- TypeScript
- Webpack / Vite
- CSS-in-JS / Tailwind CSS
- 性能优化
- 浏览器兼容性

## 回答风格
- 提供最新的最佳实践
- 给出可运行的代码示例
- 考虑性能和可维护性
- 推荐合适的工具和库
```

5. 填写飞书配置
6. 点击"创建"

---

### 场景 2: 使用自定义模型

**需求：** 使用 OpenAI 的 GPT-4o 模型

**步骤：**
1. 在创建或编辑 Gateway 时
2. 勾选"使用自定义模型"
3. 输入模型 ID: `gpt-4o`
4. 确保在 OpenClaw 主配置中已设置 OpenAI API Key

**支持的自定义模型：**
- OpenAI: `gpt-4o`, `gpt-4o-mini`, `gpt-4-turbo`
- Anthropic: `claude-3-opus-20240229`, `claude-3-sonnet-20240229`
- Google: `gemini-2.5-pro`, `gemini-2.5-flash`
- 其他兼容 OpenAI API 的模型

---

### 场景 3: 创建多个专业助手

**需求：** 为不同团队创建专属助手

**助手配置：**

#### 1. 产品经理助手
- Profile: `product-manager`
- 模型: `Claude Opus 4.6`
- 人格: 注重用户体验、数据分析、产品规划

#### 2. 设计师助手
- Profile: `designer`
- 模型: `Claude Sonnet 4.5`
- 人格: 关注视觉设计、用户界面、交互体验

#### 3. 运维工程师助手
- Profile: `devops-engineer`
- 模型: `Claude Sonnet 4.5 Thinking`
- 人格: 专注系统稳定性、自动化、监控告警

#### 4. 数据分析师助手
- Profile: `data-analyst`
- 模型: `Gemini 2.5 Pro`
- 人格: 擅长数据处理、可视化、统计分析

---

## 高级技巧

### 1. 人格设定最佳实践

**结构化定义：**
```markdown
# Agent 名称

## 角色定位
明确定义 Agent 的角色和定位

## 性格特点
- 列出 3-5 个核心性格特点
- 保持一致性

## 专业领域
- 列出专业技能
- 明确擅长的领域

## 回答风格
- 描述回答的方式
- 设定语气和风格

## 工作流程
1. 步骤化的工作方式
2. 确保逻辑清晰
3. 提供可操作的建议

## 限制和边界
- 明确不擅长的领域
- 设定合理的期望
```

### 2. 模型选择建议

**Claude Opus 4.6:**
- 最强推理能力
- 适合复杂问题分析
- 成本较高

**Claude Sonnet 4.5:**
- 平衡性能和成本
- 适合日常对话
- 推荐用于大多数场景

**Claude Sonnet 4.5 Thinking:**
- 增强的思考过程
- 适合需要深度分析的场景
- 会显示思考步骤

**Gemini 2.5 Flash:**
- 响应速度快
- 成本低
- 适合简单查询和快速响应

### 3. 端口分配建议

**推荐范围：** 18789-18799

**示例分配：**
- 18789: 主助理
- 18790: 内容创作
- 18791: 技术开发
- 18792: 数据分析
- 18793: 产品设计
- 18794: 运维支持
- 18795: 客户服务
- 18796-18799: 预留

---

## 故障排查

### 问题 1: 创建 Gateway 失败

**可能原因：**
- Profile ID 已存在
- 端口已被占用
- 缺少必填字段

**解决方法：**
1. 检查错误提示
2. 使用不同的 Profile ID
3. 选择未被占用的端口
4. 确保所有必填字段已填写

### 问题 2: Gateway 无法启动

**可能原因：**
- 配置文件格式错误
- 飞书账号配置错误
- 端口被其他程序占用

**解决方法：**
1. 检查配置文件语法
2. 验证飞书 App ID 和 Secret
3. 使用 `lsof -i :端口号` 检查端口占用
4. 查看日志文件排查错误

### 问题 3: 人格设定不生效

**可能原因：**
- SOUL.md 文件未保存
- Gateway 未重启
- Agent ID 不匹配

**解决方法：**
1. 确认 SOUL.md 已保存
2. 重启 Gateway 服务
3. 检查 Agent ID 是否正确
4. 查看 `~/.openclaw-{profile}/agent-configs/{agent}/SOUL.md`

---

## 最佳实践

### 1. 命名规范

**Profile ID:**
- 使用小写字母和连字符
- 描述性命名
- 例如: `tech-support`, `content-writer`

**Agent ID:**
- 与 Profile ID 保持一致
- 添加 `-agent` 后缀
- 例如: `tech-support-agent`

### 2. 人格设定

**清晰明确:**
- 使用简洁的语言
- 避免模糊的描述
- 提供具体的例子

**保持一致:**
- 人格特点要统一
- 回答风格要稳定
- 避免矛盾的设定

**定期优化:**
- 根据使用反馈调整
- 不断完善人格设定
- 测试不同的配置

### 3. 安全建议

**保护敏感信息:**
- 不要在 SOUL.md 中包含密钥
- 定期更换飞书 App Secret
- 限制 Gateway 的网络访问

**备份配置:**
- 定期备份 `~/.openclaw-*` 目录
- 保存重要的 SOUL.md 文件
- 记录配置变更

---

## 总结

OpenClaw Manager 提供了完整的 Gateway 管理功能：

✅ 自动发现和监控  
✅ 图形化创建和编辑  
✅ 自定义模型支持  
✅ 在线人格编辑器  
✅ 完整的 CRUD 操作  
✅ 实时状态监控  
✅ 批量服务控制  

通过这些功能，你可以轻松管理多个专业化的 AI 助手，为不同的团队和场景提供定制化的服务。

---

**更多帮助：**
- GitHub: https://github.com/xianyu110/openclaw-manager
- Issues: https://github.com/xianyu110/openclaw-manager/issues
